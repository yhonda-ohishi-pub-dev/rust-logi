# Items 機能 — DB・バックエンド完了・デプロイ済み

## 完了タスク

### DB マイグレーション (00029_create_items.sql) — 適用済み
- `set_current_user_id()` / `get_current_user_uuid()` RLS ヘルパー関数
- `items` テーブル（13カラム、階層 parent_id、barcode、quantity、dual ownership）
- PERMISSIVE RLS: `items_org_policy`（組織）+ `items_personal_policy`（個人）
- インデックス 5つ（org, user, parent, barcode, category）

### Rust バックエンド — ビルド・デプロイ済み
- `src/db/organization.rs` — `set_current_user()` ヘルパー追加
- `packages/logi-proto/proto/items.proto` — 7 RPC 定義
- `src/models/item.rs` — `ItemModel`（FromRow）
- `src/services/items_service.rs` — 全メソッド dual RLS 対応（`setup_dual_rls()`）
- 登録: build.rs, proto/mod.rs, models/mod.rs, services/mod.rs, main.rs, index.ts

### デプロイ・検証
- Cloud Run revision: `rust-logi-00108-n6g` (SERVING)
- gRPC reflection: 7 RPC 全て確認済み
- CRUD テスト: CreateItem → ListItems → DeleteItem 動作確認済み

### grpcurl テスト方法（次回参考）
Cloud Run は Authorization ヘッダーで IAM 認証、アプリは `x-auth-token` ヘッダーで JWT 認証。
JWT secret は Secret Manager (`rust-logi-jwt-secret`) から取得（ローカル .env とは異なる）。

## 未完了タスク

### フロントエンド
- [ ] `front/nuxt-items/` に symlink 方式で Nuxt プロジェクト配置
- [ ] 物品管理 UI（組織/個人切替、階層表示、バーコード検索）
- [ ] QR 生成 + ラベルプリンター印刷

## プランファイル
`plans/2026-02-22_06-08_org-slug-personal-items.md` — Phase 2 の 2.8〜2.10 完了、2.11〜2.13 が残り
