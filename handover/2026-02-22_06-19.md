# JWT org_slug 追加 — Phase 1 完了・手動検証待ち

## 完了

JWT claims に `org_slug` フィールドを追加し、SSO admin ページで参加リクエスト URL を表示する機能を実装・デプロイ済み。

### 変更ファイル

**rust-logi:**
- `src/services/auth_service.rs` — `Claims` に `org_slug` 追加、`issue_jwt()` に引数追加、全ログインメソッド（`sign_up_with_google`, `login_with_google`, `login`, `login_with_sso_provider`）で organizations JOIN して slug 取得
- `src/services/member_service.rs` — `accept_invitation` の `issue_jwt()` + invitation query に org_slug 追加
- `src/middleware/auth.rs` — `AuthenticatedUser` に `org_slug` フィールド追加

**auth-worker:**
- `src/lib/admin-html.ts` — `initAuth()` で JWT の `payload.org_slug` から join URL 表示、`updateJoinUrl()` は JWT 表示済みならスキップ

### デプロイ済み
- rust-logi: revision `rust-logi-00107-w82` (SERVING)
- auth-worker: version `d218c396-2774-4139-8707-98dea53233fe`

## 未完了

### 手動検証（1.14-1.15）
- [ ] ログイン → JWT decode → `org_slug` フィールド確認
- [ ] SSO admin ページ（https://auth.mtamaramu.com/admin/sso）で join URL 表示確認

### プランファイル
- `plans/2026-02-22_06-08_org-slug-personal-items.md` — Phase 1 チェック済み、Phase 2（個人物品管理）は将来実装

### その他未コミットの変更（git status）
- `plans/completed/` に実行済みプラン3件移動済み（access-request-oauth.md, frontend-jwt-auth.md, jwt-auth-test-plan.md）
- `build.rs`, `src/main.rs`, `src/proto/mod.rs`, `src/services/mod.rs` — 前セッションからの変更
- `packages/logi-proto/src/index.ts` — 前セッションからの変更
- `migrations/00028_create_access_requests.sql`, `src/services/access_request_service.rs` — 前セッションからの新規ファイル
